{{- $p := . -}}
{{- $link := $p.RelPermalink -}}
{{- if $p.Params.external_link -}}{{- $link = $p.Params.external_link -}}{{- end -}}

<div class="card" style="margin-bottom:20px; border:1px solid #eee; border-radius:5px; overflow:hidden;">
  {{- $imgURL := "" -}}
  {{- with $p.Params.image_path -}}
    {{- $res := resources.Get . -}}
    {{- if $res -}}
      {{- $img := $res.Fill "600x400" -}}
      {{- $imgURL = $img.RelPermalink -}}
    {{- end -}}
  {{- end -}}

  {{- if $imgURL -}}
    <a href="{{ $link }}" {{ if $p.Params.external_link }}target="_blank" rel="noopener"{{ end }}>
      <img src="{{ $imgURL }}" class="card-img-top" alt="{{ $p.Title }}" style="width:100%; height:200px; object-fit:cover;">
    </a>
  {{- end -}}

  <div class="card-body">
    <h4 class="card-title" style="font-size:1.25rem;">
      <a href="{{ $link }}" {{ if $p.Params.external_link }}target="_blank" rel="noopener"{{ end }}>{{ $p.Title }}</a>
    </h4>
  </div>
</div>
