 {{- $p := . -}}
{{- if .page -}}{{- $p = .page -}}{{- end -}}
{{- if .Page -}}{{- $p = .Page -}}{{- end -}}
{{- if .item -}}{{- $p = .item -}}{{- end -}}
{{- if .Item -}}{{- $p = .Item -}}{{- end -}}

{{- $link := $p.RelPermalink -}}
{{- if $p.Params.external_link -}}{{- $link = $p.Params.external_link -}}{{- end -}}

{{- $img := "" -}}
{{- with $p.Params.image_path -}}
  {{- with resources.Get . -}}
    {{- $img = (.Fill "120x120").RelPermalink -}}
  {{- else -}}
    {{- $img = (printf "/%s" .) -}}
  {{- end -}}
{{- end -}}

{{- $title := or $p.Title $p.Params.title -}}
{{- $summary := or $p.Params.summary $p.Summary -}}

<div class="media stream-item" style="display:flex; gap:12px; align-items:center; border:1px solid #eee; padding:12px; border-radius:8px;">
  {{- if $img -}}
  <a href="{{ $link }}" {{ if $p.Params.external_link }}target="_blank" rel="noopener"{{ end }}>
    <img src="{{ $img }}" alt="{{ $title }}" style="width:96px; height:96px; object-fit:cover; border-radius:6px;">
  </a>
  {{- end -}}
  <div>
    <h3 style="margin:0 0 4px;"><a href="{{ $link }}" {{ if $p.Params.external_link }}target="_blank" rel="noopener"{{ end }}>{{ $title }}</a></h3>
    {{- if $summary -}}<p style="margin:0;">{{ $summary }}</p>{{- end -}}
  </div>
</div>
